# TypeScript + Node.js 프리셋 규칙

> 이 프리셋은 TypeScript + Node.js (NestJS/Express) 프로젝트에 최적화된 규칙을 제공합니다.

## 변수 매핑

```yaml
# architecture.md.tmpl
ARCH_HEXAGONAL: false
ARCH_LAYERED: true
ARCH_DDD: false
MODULE_STRUCTURE_DESC: "기능별 디렉토리 구조 (src/modules/user/, src/modules/auth/)"

# coding-conventions.md.tmpl
NAMING_CONVENTION_DESC: "클래스는 PascalCase, 함수/변수는 camelCase, 상수는 UPPER_SNAKE_CASE, 파일은 kebab-case"
NAMING_PATTERN: "PascalCase(클래스), camelCase(함수), kebab-case(파일)"
FILE_NAMING_DESC: "kebab-case 파일명 (user-controller.ts, user.service.ts)"
DTO_SUFFIX: "Dto"
IMPORT_ORDER_DESC: "node 내장 → 외부 패키지 → 내부 모듈 → 상대 경로"

# api-design.md.tmpl
URL_PATTERN_DESC: "REST 표준 URL — 복수형 명사, 소문자, 하이픈 구분"
URL_PATTERN_EXAMPLE: "/api/v1/users, /api/v1/users/:id"
RESPONSE_FORMAT_DESC: "표준 응답 래퍼 — {data, message, statusCode}"
ERROR_FORMAT_DESC: "에러 응답 — {error: {code, message, details}}"
API_VERSIONING_DESC: "URL 경로 기반 버저닝 (/api/v1/)"

# error-handling.md.tmpl
EXCEPTION_HIERARCHY_DESC: "HttpException 상속 구조 (BadRequestException, NotFoundException 등)"
ERROR_CODE_FORMAT_DESC: "에러 코드 형식: MODULE.ERROR_TYPE (예: USER.NOT_FOUND, AUTH.TOKEN_EXPIRED)"

# testing.md.tmpl
TDD_POLICY_DESC: "모든 Service에 단위 테스트 필수, Controller에 e2e 테스트 필수"
COVERAGE_TARGET_DESC: "라인 커버리지 80% 이상"
TEST_DATA_POLICY_DESC: "테스트 데이터 팩토리 패턴, 인메모리 DB 또는 Testcontainers"

# security.md.tmpl
AUDIT_FIELDS_DESC: "모든 엔티티에 createdAt, updatedAt 필드 포함 (TypeORM @CreateDateColumn)"
SOFT_DELETE_DESC: "핵심 엔티티에 deletedAt 필드로 소프트 삭제 (@DeleteDateColumn)"
AUTH_POLICY_DESC: "JWT 기반 인증 (Passport.js 또는 NestJS Guards)"
AUTHZ_POLICY_DESC: "Guard/Decorator 기반 역할 검사 (@Roles, @UseGuards)"

# data-model.md.tmpl
ID_STRATEGY_DESC: "UUID v4 또는 auto-increment (프로젝트 선택)"
COMMON_FIELDS_DESC: "id, createdAt, updatedAt를 BaseEntity로 공통 관리"
FK_POLICY_DESC: "ORM 관계 데코레이터(@ManyToOne, @OneToMany)로 FK 관리"
INDEX_STRATEGY_DESC: "@Index 데코레이터로 쿼리 패턴에 맞는 인덱스 정의"

# performance.md.tmpl
CACHE_STRATEGY_DESC: "Redis 기반 캐시 (cache-manager 또는 ioredis)"
RESPONSE_TIME_DESC: "일반 API 100ms 이내, 목록 API 300ms 이내"
ASYNC_POLICY_DESC: "Bull/BullMQ 작업 큐로 무거운 작업 비동기 처리"
```

## TypeScript 전용 추가 규칙

### RULE-TS-001: strict 모드
- **원칙**: tsconfig.json에 strict: true를 사용한다
- **위반 기준**: any 타입을 명시적으로 사용하면 위반
- **검증 방법**: 코드에서 `: any` 사용 검색
- **예외**: 외부 라이브러리 타입 정의 누락 시 `as unknown as Type` 패턴 허용

### RULE-TS-002: enum 대신 as const
- **원칙**: TypeScript enum 대신 as const 객체를 사용한다
- **위반 기준**: `enum` 키워드를 사용하면 위반
- **검증 방법**: enum 선언 검색
- **예외**: NestJS 데코레이터가 요구하는 경우
