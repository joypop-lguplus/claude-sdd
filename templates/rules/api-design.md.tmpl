# API 설계 규칙

> 카테고리: API-RULE
> 이 문서의 규칙은 API URL 패턴, 응답 형식, 에러 코드 체계를 정의합니다.

## URL 패턴

### RULE-API-001: URL 형식
- **원칙**: {{URL_PATTERN_DESC}}
- **위반 기준**: URL이 정해진 패턴(예: `{{URL_PATTERN_EXAMPLE}}`)을 따르지 않으면 위반
- **검증 방법**: 라우트 정의에서 URL 패턴 확인
- **예외**: 헬스체크, 메트릭 등 인프라 엔드포인트

### RULE-API-002: HTTP 메서드 사용
- **원칙**: CRUD 오퍼레이션에 올바른 HTTP 메서드를 사용한다 (GET=조회, POST=생성, PUT=전체수정, PATCH=부분수정, DELETE=삭제)
- **위반 기준**: POST로 조회를 수행하거나, GET으로 상태를 변경하면 위반
- **검증 방법**: 라우트 정의에서 HTTP 메서드와 오퍼레이션 의미 대조
- **예외**: 복잡한 검색 조건이 URL 길이를 초과하는 경우 POST 검색 허용

## 응답 형식

### RULE-API-010: 표준 응답 구조
- **원칙**: {{RESPONSE_FORMAT_DESC}}
- **위반 기준**: 응답 JSON 구조가 정해진 형식을 따르지 않으면 위반
- **검증 방법**: Controller/Handler의 응답 직렬화 코드에서 구조 확인
- **예외**: 파일 다운로드, 스트리밍 등 바이너리 응답

### RULE-API-011: 페이지네이션
- **원칙**: 목록 API는 페이지네이션을 지원한다
- **위반 기준**: 목록 API가 전체 데이터를 반환하면 위반
- **검증 방법**: 목록 API에 page/size 또는 cursor 파라미터가 있는지 확인
- **예외**: 전체 데이터가 100건 이하로 보장되는 경우

## 에러 처리

### RULE-API-020: 에러 응답 형식
- **원칙**: {{ERROR_FORMAT_DESC}}
- **위반 기준**: 에러 응답이 정해진 구조를 따르지 않으면 위반
- **검증 방법**: 에러 핸들러/미들웨어에서 에러 응답 구조 확인
- **예외**: 없음

### RULE-API-021: HTTP 상태 코드
- **원칙**: 적절한 HTTP 상태 코드를 사용한다 (200 성공, 201 생성, 400 잘못된 요청, 401 인증 실패, 403 권한 없음, 404 미발견, 409 충돌, 422 유효성 실패, 500 서버 에러)
- **위반 기준**: 모든 에러에 500을 반환하거나, 성공에 부적절한 코드를 사용하면 위반
- **검증 방법**: Controller/Handler에서 반환하는 상태 코드가 오퍼레이션 결과와 일치하는지 확인
- **예외**: 없음

## 버저닝

### RULE-API-030: API 버전 관리
- **원칙**: {{API_VERSIONING_DESC}}
- **위반 기준**: 정해진 버저닝 전략을 따르지 않으면 위반
- **검증 방법**: URL 패턴 또는 헤더에 버전 정보가 포함되어 있는지 확인
- **예외**: 내부 전용 API

{{#if CUSTOM_API_RULES}}
## 프로젝트 커스텀 API 규칙

{{CUSTOM_API_RULES}}
{{/if}}
